\documentclass[]{beamer}

\mode<presentation>
\usetheme{CambridgeUS}
\usecolortheme{seahorse}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{xspace}
\usepackage[noend]{algorithm2e}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{ifthen,xstring,calc,pgfopts,tikz-uml}

\include{macros}

\title{\myTitle}
\subtitle{\mySubtitle}
\author{\myName}
\institute[VU]{\myUni}

% \AtBeginSection[]
% {%
%     \begin{frame}
%         \tableofcontents[currentsection,subsectionstyle=shaded]
%     \end{frame}
% }

\AtBeginSubsection[]
{%
    \begin{frame}
        \tableofcontents[currentsection,currentsubsection]
    \end{frame}
}

\begin{document}

\frame{\titlepage}

\begin{frame}{Outline}
    \tableofcontents[pausesections]
\end{frame}

\section{Background and Related Work}

\subsection{Fuzzing Techniques}

% fuzz testing
\begin{frame}{Fuzzing}
    \begin{itemize}
        \item<1-> term coined in 1988 during a quiet and stormy night\ldots\
        \item<2-> established reliability and security testing practice
        \item<2-> ``Mayhem'' wins 2016 DARPA Cyber Grand Challenge
        \item<2-> used in industry by Microsoft and Google
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{Challenges}
% TODO: example of challenging SUT
\begin{lstlisting}[language=C]
void fn(int i) {}
\end{lstlisting}
\end{frame}

\begin{frame}{Black Box Mutational Fuzzing}
    \begin{block}<+->{General operation}
        \setbeamercovered{transparent}
        \begin{enumerate}[<+->]
            \item{} select input from seed corpus
            \item{} mutate input to produce new one
            \item{} execute SUT with mutated input
            \item{} monitor for unexpected behaviours
        \end{enumerate}
    \end{block}
    \begin{exampleblock}<+->{Examples}
        \begin{itemize}
            \item{} Radamsa, zzuf
            \item{} Basic Fuzzing Framework
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Coverage-Based Gray Box Fuzzing}
    \begin{block}<+->{Overview}
        \begin{itemize}
            \item{} execution is monitored to gain \alert{feedback}
            \item{} the feedback is used to better instruct the search
        \end{itemize}
    \end{block}
    \begin{exampleblock}<+->{American Fuzzy Lop}
        \begin{itemize}
            \item{} instruments the SUT to get coverage feedback
            \item{} selects ``favorite'' inputs more often
            \item{} mutation as deterministic and havoc stages
            \item{} stores generated input if branch hit counts change bucket
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}<presentation:0>[noframenumbering]{Other Gray Box Fuzzers}
    \setbeamercovered{transparent}
    \begin{description}
        \item[AFLFast]<1>
            \begin{itemize}
                \item{} models fuzzing as Markov chain
                \item{} focus fuzzing on low frequency paths
            \end{itemize}
        \item[FairFuzz]<2>
            \begin{itemize}
                \item{} focus fuzzing on rare branches
                \item{} search strategy prioritizes inputs that hit a rare branch
                \item{} mutation preserves parts necessary to hit rare branch
            \end{itemize}
        \item[Honggfuzz]<3>
            \begin{itemize}
                \item{} simplifies operation
                \item{} uses hardware sources for coverage
            \end{itemize}
        \item[VUzzer]<4>
            \begin{itemize}
                \item{} population-based model (\ie~Evolutionary Algorithms)
                \item{} fitness function uses branch hit frequencies
                \item{} application-aware recombination and mutation operators
            \end{itemize}
    \end{description}
\end{frame}

\begin{frame}{Symbolic-Assisted White Box Fuzzing}
    \begin{block}{Key features}
        \begin{itemize}
            \item{} uses symbolic execution to collect path constraints
            \item{} constraints are solved to provide new inputs
            \item<alert@2-> constraints not always solvable or solver is slow
        \end{itemize}
    \end{block}
    \begin{exampleblock}<3->{Examples}
        \begin{itemize}
            \item{} DART and SAGE
            \item{} EXE and KLEE
            \item{} Mayhem
        \end{itemize}
    \end{exampleblock}
\end{frame}

\subsection{Hybrid and Cooperative Fuzzing}

\begin{frame}{Hybrid Approaches}
    \structure<+->{Merge white box fuzzers with black or gray box ones}
    \\~\\
    \begin{exampleblock}<+->{Driller}
        \begin{itemize}
            \item{} uses AFL and custom symbolic execution engine
            \item{} AFL becomes ``stuck'' $\rightarrow$ s.e.\ generates new inputs
        \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Cooperative Fuzzing}
    \begin{block}<+->{A system that allows fuzzers to share information to achieve a common goal}
        \begin{itemize}
            \item{} fuzzing is non-deterministic
            \item{} there is no best fuzzer for all possible programs
            \item{} information sharing as a mean to share features
                \note{example: VUzzer may share input with magic bytes to AFL}
        \end{itemize}
    \end{block}
    \begin{exampleblock}<+->{Examples}
        \begin{itemize}
            \item{} Levy Flights over an input space
            \item{} Chemotactic test case recombination
        \end{itemize}
    \end{exampleblock}
\end{frame}

\section{Cooperative Fuzzing Framework}

\subsection{System Design}

\begin{frame}{Common Fuzzer Interface}
    \begin{block}{Three API primitives}
        \begin{itemize}[<+->]
            \item{} \alert{extract} test cases from fuzzer
            \item{} \alert{inject} test cases into fuzzer
            \item{} \alert{congestion control} for slower or generational
                fuzzers
        \end{itemize}
    \end{block}
\end{frame}

\begin{frame}{Central Decisional Unit}
    \begin{columns}
        \begin{column}{.5\textwidth}
            \begin{figure}
                \includegraphics[width=.5\textwidth]{figures/dia/system_design_logical}
                \caption{Logical view}
            \end{figure}
            \begin{figure}
                \includegraphics[width=.5\textwidth]{figures/dia/system_design_physical}
                \caption{Physical view}
            \end{figure}
        \end{column}
        \begin{column}{.5\textwidth}
            \begin{itemize}
                \item{} acts as intermediary for information exchange
                \item{} uses API to implement a strategy
            \end{itemize}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}[fragile]{Cooperative Fuzzing Strategies}
\scalebox{.8}{%
    \begin{algorithm}[H]
        \DontPrintSemicolon%
        \SetKwFunction{Score}{Score}
        \SetKwFunction{Winning}{Winning}
        \SetKwFunction{Inject}{Inject}
        \SetKwFunction{WinningC}{WinningCongestion}
        % \SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
        % \Input{Set of running fuzzers $F$. Set of fuzzers that need congestion control $F_c$}
        % \BlankLine%
        \ForEach{$f \in F_c$}{%
            $W_f \leftarrow \emptyset$\;
        }
        \While{all fuzzers are running}{%
            \If{new test-case $t$ from a fuzzer $f_t$}{%
                $S \leftarrow \emptyset$\;
                \ForEach{$f \in F \setminus \{f_t\}$}{%
                    $s \leftarrow \Score{f, t}$\;
                    \uIf{$f \in F_c$}{%
                        $W_f \leftarrow W_f \cup \{(t, s)\}$\;
                    }
                    \Else{%
                        $S \leftarrow S \cup \{(f, s)\}$\;
                    }
                }
                \ForEach{$f \in \Winning{S}$}{%
                    \Inject{f, t}\;
                }
            }
            \ForEach{$f \in F_c$}{%
                \If{$f$ is ready to receive inputs}{%
                    \ForEach{$t \in \WinningC{$W_f$}$}{%
                        \Inject{f, t}\;
                    }
                    $W_f \leftarrow \emptyset$\;
                }
            }
        }
    \end{algorithm}
}
\end{frame}

\subsection{System Implementation}

\begin{frame}{Overview}
    \begin{tikzpicture}
        \umlbasiccomponent[x=-2,y=0]{Fuzzer}
        \begin{umlcomponent}[x=3,y=0]{CFF}
            \umlbasiccomponent[x=0,y=0]{Driver}
            \umlbasiccomponent[x=4,y=1.5]{Master}
            \only<3->{%
                \umlassemblyconnector[interface=Interesting,geometry=-|,%
                    anchors=180 and 90,first arm]{Master}{Driver}
            }
            \only<4->{%
                \umlassemblyconnector[interface=Metric,geometry=|-,%
                    anchors=230 and 10]{Master}{Driver}
            }
            \only<5->{%
                \umlassemblyconnector[interface=Inject,geometry=-|,%
                    anchors=-30 and 290,first arm]{Driver}{Master}
            }
        \end{umlcomponent}
        \only<2->{%
            \umlassemblyconnector[interface=API]{Driver}{Fuzzer}
        }
    \end{tikzpicture}
\end{frame}

\section{Evaluation}

\subsection{Single Fuzzers Evaluation}

\subsection{Cooperative Fuzzing Evaluation}

\subsection{Crash Analysis and Known Vulnerabilities}

\section{Discussion and Future Work}

\subsection*{Discussion}

\subsection*{Future Work}

\end{document}
